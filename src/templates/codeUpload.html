<!DOCTYPE html>
<html>
    <head>
    <!-- Bootstrap core CSS -->
    <link href= "{{ url_for('static',filename = 'css/bootstrap.min.css')}}" rel="stylesheet">
    <!-- Material Design Bootstrap -->
    <link href="{{ url_for('static',filename = 'css/mdb.min.css')}}" rel="stylesheet">
    <!-- Your custom styles (optional) -->
    <link href="{{ url_for('static',filename = 'css/style.css')}}" rel="stylesheet">
    <link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/highlight.min.js"></script>
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.32.0/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.43.0/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.43.0/mode/python/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.43.0/mode/clike/clike.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.43.0/mode/html/html.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.43.0/mode/xml/xml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.43.0/mode/htmlmixed/htmlmixed.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.43.0/addon/edit/closebrackets.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.32.0/codemirror.min.css" />

    </head>
    <body>
    

        <textarea onchange = "pasted(event)" i class="form-control z-depth-1 prettyprint" id="codeTextArea" rows="15" placeholder="Paste Code Here..."></textarea>

        <select class="browser-default custom-select" id="lang_op" onchange="changeLang(event)">
            <option selected value="text/x-csrc">C</option>
            <option value="text/x-c++src">C++</option>
            <option value="python">Python</option>
            <option value="text/x-java">Java</option>
            <option value="text/html">HTML</option>
            <option value="javascript">JavaScript</option>
        </select>
        <input id = "codeFile" onchange="uploaded(event)" type="file" class="input-group-text"/>
        <input type = "button" class="btn btn-info btn-block my-4" value = "submit"/>
        <script>
            myCodeMirror = CodeMirror.fromTextArea(document.getElementById("codeTextArea"), {
               lineNumbers: true,
                mode:  "Java",
                styleActiveLine :true,
                matchBrackets: true,
                indentUnit: 4,
                indentWithTabs: true,
                autoCloseTags: true,
                autoCloseBrackets: true,
            });
            function pasted(event)
            {
                if(event.target.value!=null)
                {
                    document.getElementById("codeFile").disabled = true;
                }
            }
            function uploaded(event)
            {
                if(event.target.files!=null)
                {

                    const reader = new FileReader()
                    reader.onload = event => {
                        alert(event.target.result);
                        myCodeMirror.getDoc().setValue(event.target.result);
                    }
                    cont  = reader.readAsText(event.target.files[0]);
                    name = event.target.files[0].name.split(".")[1];
                    lang = document.getElementById("lang_op");
                    switch(name)
                    {
                        case "py":
                            lang.selectedIndex = 2;
                            lang.onchange(this);
                            break;
                        
                            
                    }
                }
            }

            function changeLang(event)
            {
                myCodeMirror.setOption("mode",event.target.value);
                alert(myCodeMirror.getOption("mode"));
            }

           
        </script>
    </body>
</html>